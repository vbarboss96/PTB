<script>
    // LISTA COMPLETA RECUPERADA (53 ITENS)
    const baseFinal = [{"nome":"Açúcar Cristal","preco":5.49,"peso":1.0,"unid":"Kg"},{"nome":"Açúcar Refinado","preco":4.99,"peso":1.0,"unid":"Kg"},{"nome":"Canela em pó","preco":4.99,"peso":30.0,"unid":"g"},{"nome":"Chocolate ao leite Sicao","preco":164.99,"peso":2.005,"unid":"Kg"},{"nome":"Chocolate Branco Sicao","preco":209.99,"peso":2.005,"unid":"Kg"},{"nome":"Creme de Leite","preco":4.19,"peso":200.0,"unid":"g"},{"nome":"Doce de Leite Frimesa","preco":10.89,"peso":400.0,"unid":"g"},{"nome":"Farinha de Trigo","preco":6.99,"peso":1.0,"unid":"Kg"},{"nome":"Fermento em pó","preco":4.99,"peso":100.0,"unid":"g"},{"nome":"Forminha n5","preco":3.99,"peso":100.0,"unid":"un"},{"nome":"Nesquick","preco":22.99,"peso":380.0,"unid":"g"},{"nome":"Leite condensado","preco":9.99,"peso":395.0,"unid":"g"},{"nome":"Leite em Pó Ninho","preco":22.99,"peso":380.0,"unid":"g"},{"nome":"Manteiga","preco":14.99,"peso":200.0,"unid":"g"},{"nome":"Ovos","preco":25.0,"peso":30.0,"unid":"un"},{"nome":"Paçoca","preco":7.19,"peso":10.0,"unid":"un"},{"nome":"Pasta de pistache Magna Crema","preco":135.0,"peso":250.0,"unid":"g"},{"nome":"Uva","preco":13.99,"peso":500.0,"unid":"g"},{"nome":"Amendoim Vabene","preco":21.79,"peso":1.05,"unid":"Kg"},{"nome":"Chocolate Nestlé","preco":8.48,"peso":80.0,"unid":"g"},{"nome":"Cacau 50% Genuíne","preco":39.99,"peso":1.005,"unid":"Kg"},{"nome":"Granulado Vermicelli Melken","preco":49.79,"peso":400.0,"unid":"g"},{"nome":"Coloreti","preco":23.9,"peso":500.0,"unid":"g"},{"nome":"Forminha 4 Pétalas","preco":2.59,"peso":50.0,"unid":"un"},{"nome":"Embalagem Quadrada 250ml","preco":56.89,"peso":50.0,"unid":"un"},{"nome":"Coco desidratado","preco":9.99,"peso":100.0,"unid":"g"},{"nome":"Massa de beijinho","preco":0.2,"peso":4.0,"unid":"g"},{"nome":"Coco ralado menina","preco":4.99,"peso":100.0,"unid":"g"},{"nome":"Forminha n4 Regina","preco":3.39,"peso":100.0,"unid":"un"},{"nome":"Doce de Leite Portão","preco":30.79,"peso":1.0,"unid":"Kg"},{"nome":"Ninho cremoso","preco":20.53,"peso":670.0,"unid":"g"},{"nome":"Ganache chocolate","preco":5.53,"peso":180.0,"unid":"g"},{"nome":"Granulado Granulé","preco":45.99,"peso":400.0,"unid":"g"},{"nome":"Massa Casadinho Leite","preco":21.13,"peso":550.0,"unid":"g"},{"nome":"Massa Casadinho Ninho","preco":18.14,"peso":470.0,"unid":"g"},{"nome":"Açucar Mascavo","preco":10.99,"peso":1.0,"unid":"Kg"},{"nome":"Sal","preco":4.99,"peso":1.0,"unid":"Kg"},{"nome":"Bicarbonato","preco":3.69,"peso":250.0,"unid":"g"},{"nome":"Cacau 100% Genuíne","preco":44.99,"peso":500.0,"unid":"g"},{"nome":"Choc. Meio Amargo Melken","preco":159.99,"peso":2.005,"unid":"Kg"},{"nome":"Choc. Branco Melken","preco":163.99,"peso":2.005,"unid":"Kg"},{"nome":"Fini Camping","preco":8.39,"peso":250.0,"unid":"g"},{"nome":"Choc. Ao Leite Melken","preco":162.99,"peso":2.005,"unid":"Kg"},{"nome":"Corante Vermelho","preco":4.99,"peso":25.0,"unid":"g"},{"nome":"Essencia Baunilha","preco":13.99,"peso":960.0,"unid":"ML"},{"nome":"Negresco 1kg","preco":50.99,"peso":1.0,"unid":"Kg"},{"nome":"Nutella","preco":190.0,"peso":3.0,"unid":"Kg"},{"nome":"Confeito Mavalério","preco":4.99,"peso":150.0,"unid":"g"},{"nome":"Pistache cremoso","preco":65.3,"peso":585.0,"unid":"g"},{"nome":"Doce de Leite Cremoso","preco":13.9,"peso":360.0,"unid":"g"},{"nome":"Brownie 5x5","preco":2.32,"peso":35.0,"unid":"g"},{"nome":"Colher descartavel","preco":29.9,"peso":50.0,"unid":"un"},{"nome":"Brigadeiro Coxinha","preco":33.7,"peso":560.0,"unid":"g"}];

    let db = [];
    try {
        db = JSON.parse(localStorage.getItem('pitadaDataV7.5')) || baseFinal;
    } catch(e) {
        db = baseFinal;
    }
    
    let recipeItems = [];
    let currentPage = 1;
    const itemsPerPage = 10;

    function normalize(s) { return s ? s.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase() : ""; }

    // BOTÃO DE ABAS CORRIGIDO
    window.switchTab = function(tab) {
        document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        const target = document.getElementById('tab-' + tab);
        if(target) target.style.display = 'block';
        
        // Ativa o botão correto no menu
        const items = document.querySelectorAll('.nav-item');
        if(tab === 'ingredientes') items[0].classList.add('active');
        if(tab === 'receitas') items[1].classList.add('active');
        
        renderIngs();
    };

    function maskBRL(i) {
        let v = i.value.replace(/\D/g,'');
        v = (v/100).toFixed(2).replace(".", ",");
        v = v.replace(/(\d)(\d{3})(\d{3}),/g, "$1.$2.$3,");
        v = v.replace(/(\d)(\d{3}),/g, "$1.$2,");
        i.value = "R$ " + v;
    }

    function parseNum(v) { return parseFloat(v.toString().replace(",", ".")) || 0; }
    function parseBRL(v) { return parseFloat(v.replace(/[R$\s.]/g, "").replace(",", ".")) || 0; }

    window.handleSave = function() {
        try {
            const nome = document.getElementById('in-nome').value.trim();
            const preco = parseBRL(document.getElementById('in-preco').value);
            const peso = parseNum(document.getElementById('in-peso').value);
            const unid = document.getElementById('in-unid').value;
            const editId = parseInt(document.getElementById('edit-id').value);

            if(!nome || preco <= 0 || peso <= 0) {
                alert("Preencha todos os campos!");
                return;
            }
            
            if(editId > -1) {
                db[editId] = { nome, preco, peso, unid };
            } else {
                db.push({ nome, preco, peso, unid });
            }
            
            localStorage.setItem('pitadaDataV7
